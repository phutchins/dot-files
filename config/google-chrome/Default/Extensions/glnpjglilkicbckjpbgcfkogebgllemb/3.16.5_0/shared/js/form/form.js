(function(h,n,f){var e={INVALID:0,LOGIN:1,CHANGE_PASSWORD:2},j=500,b=[/log\s*in/i,/save/i];function k(p,q){m(p,["focus","keydown","keypress"]);p.val(q);m(p,["input","keyup","change","blur"])}function d(p){m(p,["mousedown","mouseup","click"])}function m(q,p){n(p).each(function(r){try{q.simulate(r)}catch(s){}})}function o(p,q){return l(a(c(p),q),q)}function c(q){var p;if(q.length<=1){return q}p=n.map(q,function(r){return{element:r,parents:h(r).parents().get().reverse()}});return h(n.pluck(n.reject(p,function(s){var r=s.parents;return n.some(p,function(t){return r.length<t.parents.length&&s.element===t.parents[r.length]})}),"element"))}function a(q,r){var p;if(q.length<=1||!r){return q}p=r.parents().get().reverse();return h(n.map(n.min(n.groupBy(n.map(q,function(t){var s,u,v;s=h(t).parents().get().reverse();v=Math.min(s.length,p.length);for(u=0;u<v;u++){if(s[u]!==p[u]){break}}return{element:t,distance:p.length-u}}),"distance"),function(s){return s[0].distance}),function(s){return s.element}))}function l(p,q){var r;if(p.length<=1||!q){return p}r=g(q);return h(n.min(p,function(s){var t=g(h(s));return Math.sqrt(Math.pow(t.left-r.left,2)+Math.pow(t.top-r.top,2))}))}function i(q,p){return h(n.filter(q,function(s){var r=h(s).text()||s.value;return n.reduce(p,function(t,u){return t||u.test(r)},false)}))}function g(p){var q=p.offset();q.top+=p.height()/2;q.left+=p.width()/2;return q}Okta.Form=function(p){this.$el=n.isUndefined(p.jquery)?h(p):p;this._type=undefined;this._userField=undefined;this._passField=undefined;this._submitBtn=undefined;this._serializeFields=[];this._lastSubmit=0;this._initialize()};n.extend(Okta.Form.prototype,Okta.Events,{isLoginForm:function(){return this._type===e.LOGIN},isChangePasswordForm:function(){return this._type===e.CHANGE_PASSWORD},exists:function(){var p,q;p=!this.$el.is(":not(:visible)")||this.$el.css("display")==="inline";q=!this._userField.add(this._passField).add(this._submitBtn).is(":not(:visible)");return p&&q},fillCreds:function(p){if(!this.isLoginForm()&&!this.isChangePasswordForm()){throw"Trying to fill creds on unidentified form"}if(!p||n.isUndefined(p.username)||n.isUndefined(p.password)){throw"Trying to fill creds with invalid creds object"}f("filling creds");if(this.isLoginForm()){k(this._userField,p.username)}k(this._passField,p.password)},submit:function(){if(!this.isLoginForm()){throw"Trying to submit with invalid form type"}f("submitting form");if(this._submitBtn){d(this._submitBtn)}else{this.$el.submit()}},serialize:function(){return n.map(this._serializeFields,function(p){return{type:p.get(0).type,value:p.val()}})},unregister:function(){this.$el.add("*",this.$el).off(".okta-form")},_initialize:function(){var p=this,r=[],q=[];this.$el.find(":input:visible").each(function(){var s=h(this);switch(this.type){case"text":case"email":case"textarea":r.push(s);p._serializeFields.push(s);break;case"password":q.push(s);p._serializeFields.push(s);break}});if(r.length===1&&q.length===1){this._type=e.LOGIN;this._userField=r[0];this._passField=q[0];this._registerSubmitHandlers()}else{if(q.length>1&&q.length<4){this._type=e.CHANGE_PASSWORD;this._passField=q[0];this._registerSubmitHandlers()}else{this._type=e.INVALID}}f("found {0} text, {1} pass - {2} form",r.length,q.length,this.isLoginForm()?"login":(this.isChangePasswordForm()?"change password":"unknown"))},_registerSubmitHandlers:function(){this._submitBtn=this._findSubmitButton();this.$el.on("submit.okta-form",n.bind(this._triggerSubmit,this));if(this._submitBtn){this._submitBtn.on("click.okta-form",n.bind(this._triggerSubmit,this))}},_findSubmitButton:function(){var p;p=o(this.$el.find(':submit, input[type="image"]'),this._passField);if(p.length>0){return p}p=o(i(this.$el.find('a, button, input[type="button"]'),b),this._passField);if(p.length>0){return p}p=o(i(this.$el.find("span, div"),b),this._passField);if(p.length>0){return p}return null},_triggerSubmit:function(){var p=new Date().getTime();if(p-this._lastSubmit>j){f("submit detected - triggering submit event");this.trigger("okta-form-submit");this._lastSubmit=p}}})}($okta,_okta,function(){var a=Array.prototype.slice.apply(arguments);a[0]="Okta.Form: "+a[0];Log.debug.apply(null,a)}));