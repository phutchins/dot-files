function SaveController(e,a){var b=this;var f;function c(){var g=f.getSelectedValue();if(!g){return}var h={username:a.formData.username,password:a.formData.passwords[0],appUserId:g.id};b.o.events.onSave(h)}function d(i){Log.debug("SaveController::initSiteList: "+a.matchedSites.length);var g=0;if(a.matchedSites.length>1&&a.matchedSite){g=$okta.inArray(a.matchedSite.id,_okta(a.matchedSites).map(function(j){return j.id}))}Log.debug("SaveController::initSiteList2");var h=new oktaPlugin.Widget.DropDown(e);h.create(a.matchedSites,oktaPlugin.Widget.DropDown.appInstanceDisplayFunc,g);f=h;i.getControlDiv().prepend(h.getRootElm())}this.init=function(g){d(g);return{onSaveClicked:c}};this.o={events:{onSave:null}}}function SavePasswordBar(d,f){var c,b;var e=false;function a(g){f("doSave",g)}this.create=function(i,h){Log.debug("SavePasswordBar::create");c=i.prepareOnce();var l=h.isChangePassword?"It looks like your password changed. Do you want Okta to update your credentials for this site?":"Do you want Okta to save your credentials for this site?";b=new OktaNotifyBar(d,c);var k=b.o;k.msg=l;k.button1.text=h.isChangePassword?"Update":"Save";k.button2.text="Never";k.events.onClose=function(){e=false;f("clearPersistedPasswordBar")};k.events.button2Click=function(){f("neverThisUrl");b.close()};b.create({cssClass:"x-save-cred-bar"+(h.isFromChangePwForm?" x-from-change-pw-form":"")});var j=new SaveController(c,h);j.o.events.onSave=function(m){a(m);b.close()};var g=j.init(b);k.events.button1Click=g.onSaveClicked;b.appendToDom();e=true};this.isOpen=function(){return e};this.close=function(){if(b){if(e){b.close()}b=null}}};